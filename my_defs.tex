\newtheorem{theorem}{Theorem}
\newtheorem*{thm*}{Theorem}
\newtheorem{corollary}{Corollary}
\newtheorem{lemma}{Lemma}
\newtheorem*{lemma*}{Lemma}
\newtheorem{proposition}{Proposition}
\newtheorem*{proposition*}{Proposition}
\newtheorem{exercise}{Exercise}
\newtheorem*{remark*}{Remark}
\newtheorem*{surfacecor}{Corollary 1}
\newtheorem{conjecture}{Conjecture} 
\newtheorem{question}{Question} 
\theoremstyle{definition}
\newtheorem{definition}{Definition}

\let\mod\undefined
\let\Re\undefined
\let\Im\undefined
\let\vec\undefined

\DeclareMathOperator{\diag}{diag}
%\newcommand{\diag}{\mathrm{diag}}
\DeclareMathOperator{\Col}{Col}
\DeclareMathOperator{\Row}{Row}
\DeclareMathOperator{\Span}{span}
\DeclareMathOperator{\Nul}{Nul}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\conv}{conv}
\DeclareMathOperator{\cone}{cone}
\DeclareMathOperator{\aff}{aff}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator{\circop}{circ}
\DeclareMathOperator{\mod}{\mathbin{mod}}
\DeclareMathOperator{\vol}{vol}
\DeclareMathOperator{\Re}{Re}
\DeclareMathOperator{\Im}{Im}
\DeclareMathOperator{\Proj}{Proj}
\DeclareMathOperator{\vec}{vec}
\DeclareMathOperator{\mat}{mat}

\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}
\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclarePairedDelimiter{\norm}{\lVert}{\rVert}
\DeclarePairedDelimiter{\abs}{\lvert}{\rvert}
\DeclarePairedDelimiter{\inner}{\langle}{\rangle}

\newcommand{\R}{\ensuremath{\mathbb{R}}}  % The real numbers.
\newcommand{\C}{\ensuremath{\mathbb{C}}}
\newcommand{\N}{\ensuremath{\mathbb{N}}}
\newcommand{\Z}{\ensuremath{\mathbb{Z}}}
\renewcommand{\H}{\ensuremath{\mathcal{H}}}
\newcommand{\sym}{\mathcal{S}}
\newcommand{\Sbb}{\ensuremath{\mathbb{S}}}
\newcommand{\B}{\ensuremath{\mathcal{B}}}
\newcommand{\Rn}{\ensuremath{\R^n}}
\newcommand{\Rm}{\ensuremath{\R^m}}
\newcommand{\Cn}{\ensuremath{\C^n}}
\newcommand{\mfr}{\mathfrak{R}}
\newcommand{\ulmfr}{\underline{\mfr}}
\newcommand{\Rmxn}{\ensuremath{\R^{m \times n}}}
\newcommand{\Cmxn}{\ensuremath{\C^{m \times n}}}
\newcommand{\Rnxn}{\ensuremath{\R^{n \times n}}}
\newcommand{\Cnxn}{\ensuremath{\C^{n \times n}}}
\newcommand{\bigfrac}[2]{\ensuremath{\frac{\displaystyle #1}{\displaystyle #2}}}
\newcommand{\kron}{\otimes}
\newcommand{\iid}{\overset{\text{i.i.d.}}{\sim}}
\newcommand{\ee}{\mathrm{e}}
\newcommand{\ii}{\mathrm{i}}
\renewcommand{\th}{\ensuremath{^{\text{th}}}}
\newcommand{\ow}{\text{otherwise}}
\renewcommand{\c}{\ensuremath{\mathbf{c}}}
\newcommand{\x}{\ensuremath{\mathbf{x}}}
\newcommand{\m}{\ensuremath{\mathbf{m}}}
\newcommand{\y}{\ensuremath{\mathbf{y}}}
\newcommand{\tf}{\ensuremath{\tilde{f}}}
\newcommand{\ux}{\underline{x}}
\newcommand{\uz}{\underline{z}}
\newcommand{\uX}{\underline{X}}
\newcommand{\uR}{\underline{R}}
\newcommand{\utX}{\underline{\tX}}
\newcommand{\uL}{\underline{L}}
\newcommand{\uW}{\underline{W}}
%% \newcommand{\Fb}{\overline{F}}
\newcommand{\tF}{\widetilde{F}}
\newcommand{\Lc}{\mathcal{L}}
\newcommand{\Rc}{\mathcal{R}}
\newcommand{\Ac}{\mathcal{A}}
\newcommand{\hz}{\hat{z}}
\newcommand{\hZ}{\hat{Z}}
\newcommand{\hL}{\hat{L}}
\renewcommand{\v}{\ensuremath{\mathbf{v}}}
\renewcommand{\u}{\ensuremath{\mathbf{u}}}
\newcommand{\F}{\ensuremath{\mathcal{F}}}
\newcommand{\mg}{martingale}
\newcommand{\E}{\ensuremath{\mathbb{E}}}
\newcommand{\rv}{random variable}
\newcommand{\psd}{\ensuremath{\mathcal{S}_+}}
\newcommand{\psdn}{\ensuremath{\mathcal{S}_+^n}}
\newcommand{\bigO}{\mathcal{O}}
\newcommand{\one}{\ensuremath{\mathbbm{1}}}
\renewcommand{\a}{\ensuremath{\overline{a}}}
\newcommand{\dbar}{\overline{d}}
\newcommand{\deltabar}{\overline{\delta}}
\newcommand{\mintheta}{\min_{\theta \in [0, 2\pi]}}
\newcommand{\eit}{\ee^{\ii \theta}}
\newcommand{\eiti}{\ee^{\ii \theta_i}}
\newcommand{\conj}[1]{\overline{#1}}
\renewcommand{\subset}{\subseteq}

\newcommand{\rowmat}[3]{\ensuremath{\begin{bmatrix} #1_{#2} & \cdots & #1_{#3} \end{bmatrix}}}
\newcommand{\rowmatfun}[3]{
  \ensuremath{
    \begin{bmatrix}
      \StrSubstitute{#1}{@}{{#2}} &
      \cdots &
      \StrSubstitute{#1}{@}{{#3}}
    \end{bmatrix}
  }
}
\newcommand{\colmat}[3]{\ensuremath{\begin{bmatrix} #1_{#2} \\ \vdots \\ #1_{#3} \end{bmatrix}}}
\newcommand{\colmatfun}[3]{
  \ensuremath{\noexpandarg
    \begin{bmatrix}
      \StrSubstitute{#1}{@}{{#2}} \\
      \vdots \\
      \StrSubstitute{#1}{@}{{#3}}
    \end{bmatrix}
  }
}
\newcommand{\diagcornmat}[2]{
  \ensuremath{
    \begin{bmatrix}
      #1 & \cdots & 0 \\
      \vdots & \ddots & \vdots \\
      0 & \cdots & #2
    \end{bmatrix}
  }
}
\newcommand{\bigdiagcornmat}[2]{
  \ensuremath{
    \begin{bmatrix}
      #1 & 0 & \cdots & 0 \\
      0 & \ddots & & \vdots \\
      \vdots & & \ddots & 0 \\
      0 & \cdots & 0 & #2
    \end{bmatrix}
    }
  }
\newcommand{\diagmat}[3]{
  \diagcornmat{#1_{#2}}{#1_{#3}}
}
\newcommand{\diagmatfun}[3]{
  \diagcornmat{\StrSubstitute{#1}{@}{#2}}{\StrSubstitute{#1}{@}{#3}}
}
\newcommand{\cornmat}[5]{
  \ensuremath{
  \begin{bmatrix} #1_{#2#4} & \cdots & #1_{#2#5} \\
    \vdots & \ddots & \vdots \\
    #1_{#3#4} & \cdots & #1_{#3#5}
  \end{bmatrix}
  }
}
\newcommand{\cornmatfun}[5]{
  \ensuremath{
    \StrSubstitute{#1}{@r}{{#2}}[\cmftop]
    \StrSubstitute{#1}{@r}{{#3}}[\cmfbot]
  \begin{bmatrix} \StrSubstitute{\cmftop}{@c}{{#4}} & \cdots & \StrSubstitute{\cmftop}{@c}{{#5}} \\
    \vdots & \ddots & \vdots \\
    \StrSubstitute{\cmfbot}{@c}{{#4}} & \cdots & \StrSubstitute{\cmfbot}{@c}{{#5}}
  \end{bmatrix}
  }
}

\newcommand{\BPnote}[1]{\textcolor{ForestGreen}{[{\em {\bf **BP Note:} #1}]}}

\newcommand{\crefrangeconjunction}{--}

\newenvironment{remark}
               {\textbf{Remark.}}
               {}
               
\newenvironment{piecewise}
               {\left\{\begin{array}{r@{,\quad}l}}
               {\end{array}\right.}
