\section{Vector Synchronization as Angular Synchronization}
One subproblem that arises in some of the alternative reconstruction algorithms proposed in, e.g., \cref{sec:ptych_recov}, is that of \emph{vector synchronization}, where, given a set of vectors $\{v_j\}_{j \in [n]} \subset \Cd$ and a graph $G = (V = [n], E)$, we want to find phases that minimize the pairwise distances between the $v_j$ that are connected by the edges of the graph.  More specifically, we want to solve \begin{equation} \minthetas{j} \sumedge \norm{\eits{i} v_i - \eits{j} v_j}_2^2. \label{eq:vec_sync} \end{equation}  In this section, we prove a short lemma that shows that this problem is equivalent to a certain instantiation of angular synchronization (see \cref{ch:ang_sync}), and therefore may be solved using the technology and enjoying the recovery guarantees developed elsewhere in that chapter.

We derive this equivalence by showing that the minimizer $(\theta_i)$ for \eqref{eq:vec_sync} is the same as the minimizer for \begin{equation} \mintheta \sumedge \abs{v_i^* v_j} \abs{\eits{i} - \sgn(v_i^* v_j) \eits{j}}^2, \label{eq:vec_ang_sync} \end{equation} which is, by following \crefrange{eq:ang_sync_cost}{eq:ang_sync}, an angular synchronization problem with \begin{equation} \begin{gathered} W = \abs*{\rowmat{v}{1}{n}^* \rowmat{v}{1}{n}} \circ A_G, \\ X = \sgn\left(\rowmat{v}{1}{n}^* \rowmat{v}{1}{n}\right) \circ A_G, \\ D = \diag(W \one)\end{gathered} \label{eq:vec_sync_mats}\end{equation} where $\abs{\cdot}$ and $\sgn(\cdot)$ are taken elementwise and $A_G$ is the adjacency matrix of $G$.  For convenience, we identify $\omega_j := \eits{j} \in \Sbb^1$ and consider that the argument of \eqref{eq:vec_sync} may be rewritten as \[\sumedge \norm{\omega_i v_i - \omega_j v_j}_2^2 = \sumedge \norm{v_i}^2 + \norm{v_j}^2 - 2 \Re(\omega_i^* \omega_j v_i^* v_j).\]  Since the $\norm{v_i}^2$ terms do not depend on $\omega_i$, this is minimized by \[\argmax_{\omega_i \in \Sbb^1} \sumedge \Re(\omega_i^* \omega_j v_i^* v_j) = \argmax_{\omega_i \in \Sbb^1} \abs{v_i^* v_j} \Re(\sgn(v_i^* v_j) \omega_i^* \omega_j).\]  Similarly, we rewrite the argument of \eqref{eq:vec_ang_sync} as \begin{equation} \sumedge \abs{v_i^* v_j} \abs{\eits{i} - \sgn(v_i^* v_j) \eits{j}}^2 = \sumedge \abs{v_i^* v_j} \left(2 - 2 \Re(\sgn(v_i^* v_j) \omega_i^* \omega_j)\right),\label{eq:vec_as_re}\end{equation} which is clearly minimized by \[\argmax_{\omega_i \in \Sbb} \sumedge \abs{v_i^* v_j} \Re(\sgn(v_i^* v_j) \omega_i^* \omega_j).\]  The minimizers of these two problems coincide, so by solving \eqref{eq:vec_ang_sync}, we obtain a solution to \eqref{eq:vec_sync}.

In order to state a recovery guarantee, we need to have a notion of a ground truth, and how we might consider the measurements $v_i$ (or $v_i^* v_j, (i, j) \in E$, since \eqref{eq:vec_ang_sync} is completely determined by this data alone) to be noisy.  To establish this, we observe, in light of \eqref{eq:vec_as_re}, that the minimum value of \eqref{eq:vec_ang_sync} is zero iff there exist $\omega_i$ such that $\sgn(v_i^* v_j) \omega_i^* \omega_j = 1$ for all $(i, j) \in E$, which happens iff $D - W \circ X$ has a nullspace (further, as before, this solution is unique iff this nullspace has dimension 1, which requires the graph described by $W$ to be connected).  Therefore, given a graph $G = (V = [n], E)$ and a set of vectors $\{v_j\}_{j \in [n]} \subset \Cd$, we say that $v_j$ is \emph{$G$-consistent} if $\dim\Nul(D - W \circ X) = 1$, with $W, X, D$ defined as in \eqref{eq:vec_sync_mats}.  Then, with the previous discussion proving the coincident minimizers of \cref{eq:vec_sync,eq:vec_ang_sync} and \cref{thm:ang_sync_dual}, we have \cref{prop:vec_sync}.  This proposition states that, if $\{v_j\}_{j \in [n]}$ is a perturbed version of some $G$-consistent $\{\uv_j\}_{j \in [n]}$, then the synchronizing angles $\hat{\omega_j}$ of the $v_j$ are close to the synchronizing angles $\underline{\omega}_j$ of the $\uv_j$ and may be recovered according to the SDP relaxations discussed in \cref{sec:ang_sync_sdp} if the perturbation is small enough.

\begin{proposition} \label{prop:vec_sync}
  Suppose that $\{\uv_j\}_{j \in [n]} \subset \Cd$ are $G$-consistent for some graph $G = (V = [n], E)$, and let $\{v_j\}_{j \in [n]}$ be arbitrary.  Define $\underline{D}, \uW, \uX, D, W,$ and $X$ according to \eqref{eq:vec_sync_mats}, and $\uL = \underline{D} - \uW \circ \uX, L - D - W \circ X$.  Let $\tau = \lambda_2(\underline{D} - \uW)$.  Suppose that $\hat{\omega} \in (\Sbb^1)^n,$ with $\hat{\omega_j} = \eits{j}$ minimizes \eqref{eq:vec_sync}, and that $\underline{\omega} \in (\Sbb^1)^n$ spans $\Nul(\underline{D} - \uW \circ \uX)$.  Then if $\norm{L - \uL}_2 < \frac{\tau}{1 + \sqrt{n}}, \hat{\Omega} = \hat{\omega} \hat{\omega}^*$ and $\mfr(\hat{\Omega})$ are the unique minimizers of  \eqref{eq:ang_sync_sdp} and \eqref{eq:ang_sync_real}.  In any case, we have \[\mintheta \norm{\hat{\omega} - \eit \underline{\omega}}_2 \le \dfrac{2 \sqrt{2 n} \norm{\uL - L}_2}{\tau}.\]
\end{proposition}
The end goal of this proposition is, setting $\uV = \rowmat{\uv}{1}{n}$ and $V = \rowmat{v}{1}{n}$, to find alignments $\uV D_{\omega_1}$ and $V D_{\omega_2}$ of the $\uv_j$'s and the $v_j$'s for which we can control the distance between them in terms of $\norm{\uV - V}$.\footnote{We remark that the bound we find here is markedly unsharp, as we use several costly inequalities to prove it.  Its interest lies primarily in establishing that the vector synchronization problem is continuous, in the sense that the alignment $V D_{\hat{\omega}}$ satisfies $V D_{\hat{\omega}} \to \uV D_{\underline{\omega}}$ as $V \to \uV$.}  Specifically, we want to bound
\begin{align*}
  \mintheta \norm{\uV D_{\underline{\omega}} - \eit V D_{\hat{\omega}}}_F &\le \mintheta \norm{\uV (D_{\underline{\omega}} - \eit D_{\hat{\omega}})}_F + \norm{\uV - V}_F \\
  &\le \mintheta \norm{\uV}_F \norm{\hat{\omega} - \eit \underline{\omega}}_\infty + \norm{\uV - V}_F \\
  &\le \dfrac{2 \sqrt{2 n} \norm{\uL - L}_2}{\tau} \norm{\uV}_F + \norm{\uV - V}_F
\end{align*}
To bound the $\norm{\uL - L}_2$ term, we observe \[\uL - L = \diag(((\uV^* \uV - V^* V) \circ A_G) \one) - (\uV^* \uV - V^* V) \circ A_G.\]  If we then write $V = \uV + N$, then $\uV^* \uV - V^* V = - N^* \uV - \uV^* N - N^*N$ which gives $\norm{\uV^* \uV - V^* V}_F \le \norm{N}_F(2 \norm{\uV}_2 + \norm{N}_F)$.  We use \[\begin{aligned}\norm{\diag(X \circ A_G \one)}_2 &= \norm{X \circ A_G \one}_\infty \le \norm{X \circ A_G \one}_2 \\ &\le \sqrt{n} \norm{X \circ A_G}_2 \le \sqrt{n} \norm{X}_F\end{aligned}\] to obtain $\norm{\uL - L}_2 \le (\sqrt{n} + 1) \norm{N}_F(2 \norm{\uV}_2 + \norm{N}_F)$, which gives the following corollary of \cref{prop:vec_sync}.

\begin{corollary}
  Accept the notation of \cref{prop:vec_sync}, and additionally set $N = \uV - V$, where $\uV = \rowmat{\uv}{1}{n}$ and $V = \rowmat{v}{1}{n}$.  Then \begin{equation} \mintheta \norm{\uV D_{\underline{\omega}} - \eit V D_{\hat{\omega}}}_F \le  \norm{N}_F \left(\dfrac{4 \sqrt{2} n}{\tau} \norm{\uV}_F (2 \norm{\uV}_2 + \norm{N}_F) + 1\right) \label{eq:vec_sync_bnd} \end{equation} \label{cor:vec_sync_bnd}
\end{corollary}

\section{Phase Retrieval by Vector Synchronization}
\label{app:vecky_vec}
Here, we recall the setting of \cref{sec:pty_vec_sync} and the notation of \cref{alg:vecky_vec,alg:pty_vec}.  To prove that this process is continuous with respect to $n$, in the sense that \[\lim_{\norm{n}_2 \to 0} \mintheta \norm{x - \ux}_2 = 0,\] we straightforwardly combine \cref{cor:rank1Bound,cor:vec_sync_bnd} with \cref{lem:vecky_vec} to get \cref{prop:vecky_vec}.

\begin{lemma} \label{lem:vecky_vec}
  Let $X, (\{J_i\}_{i \in [N]}, G)$ be a valid input to \cref{alg:vecky_vec}, and suppose $\uX = \ux \ux^*$ for some $\ux \in \Cd$.  Then \begin{equation}\begin{gathered}\min_{\omega \in (\Sbb^1)^N} \norm*{\BlkVec(X, \{J_i\}) - \rowmatfl{\ux^{(J_1)}}{\ux^{(J_N)}} D_\omega}_2 \le \\ \dfrac{(1 + 2 \sqrt{2}) \sqrt{\max_j \mu_j}}{\min_i \norm{\ux^{(J_i)}}_2} \norm{X - \uX}_F,\end{gathered} \label{eq:vecky_vec_diff} \end{equation} where $\mu_j = \abs{\{i : i \in J_j\}}$.
\end{lemma}

\begin{proof}[Proof of \cref{lem:vecky_vec}]
  The proof proceeds very similarly to that of \cref{prop:blocky_block}.  Namely, we set $V = \BlkVec(X, \{J_i\}), \uV = \BlkVec(\uX, \{J_i\}),$ and $\Delta_\omega = V - \uV D_\omega$ and find
  \begin{align*}
    \min_{\omega \in (\Sbb^1)^N} \norm{\Delta_\omega}_F^2 &= \sum_{i = 1}^N \min_{\omega_i \in \Sbb^1} \norm{x^{(J_i)} - \omega_i \ux^{(J_i)}}_2^2 \\
    &\le (1 + 2 \sqrt{2})^2 \dfrac{\norm{X^{(J_i)} - \uX^{(J_i)}}_F^2}{\norm{\ux^{(J_i)}}_2^2} \\
    &\le \frac{(1 + 2 \sqrt{2})^2 \max_j \mu_j}{\min_i \norm{\ux^{(J_i)}}_2^2} \norm{X - \uX}_F^2
  \end{align*}  
\end{proof}

\begin{proposition} \label{prop:vecky_vec}
  Let $y, (\{J_i\}_{i \in [N]}, G')$ be a valid input to \cref{alg:pty_vec} where $y = \Ac(\ux \ux^*) + n$ for some $\ux \in \Cd, n \in \R^{\dbar D}$.  Then setting \[\begin{gathered}X = \Ac^{-1}(y), \uX = \ux \ux^*, V = \rowmatfl{x^{(J_1)}}{x^{(J_N)}}, \\ \uV = \rowmatfl{\ux^{(J_1)}}{\ux^{(J_N)}}, \Delta = V - \uV D_{\hat{\omega}},\end{gathered}\] where \[\hat{\omega} = \argmin_{\omega \in (\Sbb^1)^N} \norm{V - \uV D_\omega}_F\] and $\mu_j$ as in line 1 of \cref{alg:vecky_vec}, the output $x$ satisfies \[\begin{aligned}\mintheta \norm{x - \eit \ux}_2 &\le \frac{d^{1/2}}{\min_j \mu_j}\norm{\Delta}_F\left(\frac{4 \sqrt{2} N}{\tau_{G'}} \norm{\uV}_F(2 \norm{\uV}_2 + \norm{\Delta}_F) + 1\right), \ &\text{where} \\ \norm{\Delta}_F &\le (1 + 2 \sqrt{2}) \frac{\sqrt{\max_j \mu_j}}{\min \norm{\ux^{(J_i)}}_2} \norm{X - \uX}_F \ &\text{and} \\ \norm{X - \uX}_F &\le \sigma_{\min}^{-1}(\Ac) \norm{n}_2, \end{aligned}\] so that \[\lim_{\norm{n}_2 \to 0} \mintheta \norm{x - \eit\ux}_2 = 0.\]
\end{proposition}

\begin{proof}[Proof of \cref{prop:vecky_vec}]
  We begin with an attempt to apply \cref{cor:vec_sync_bnd}, so we accept its notation and write \[x = D_\mu^{-1} V \hz = D_\mu^{-1} V D_{\hz} \one_N \ \text{and} \ \ux = D_\mu^{-1} \uV D_{\underline{\omega}} \one_N = D_\mu^{-1} \uV D_{\hat{\omega}} D_{\underline{\omega} \circ \conj{\hat{\omega}}} \one_N,\] so that we may immediately reach the bound \[\mintheta \norm{x - \eit \ux}_2 \le \frac{\sqrt{N}}{\min_j \mu_j} \mintheta \norm{V D_{\hz} - \eit \uV D_{\hat{\omega}} D_{\underline{\omega} \circ \conj{\hat{\omega}}}}_2.\]  We remark that if $\underline{\omega}$ minimizes \eqref{eq:vec_sync} for $\uV$, then $\underline{\omega} \circ \conj{\hat{\omega}}$ minimizes \eqref{eq:vec_sync} for $\uV D_{\hat{\omega}}$.  Hence, upper bounding $\norm{\cdot}_2$ with $\norm{\cdot}_F$, we may apply \cref{cor:vec_sync_bnd} to obtain \[\mintheta \norm{x - \eit \ux}_2 \le \frac{\sqrt{N}}{\min_j \mu_j} \norm{\Delta}_F \left(\frac{4 \sqrt{2} N}{\tau_{G'}} \norm{\uV}_F(2 \norm{\uV}_2 + \norm{\Delta}_F) + 1\right),\] which is the first of the three inequalities desired.  The second comes immediately from \cref{lem:vecky_vec}, and the last comes from $\Ac(X - \uX) = n$.
\end{proof}

