In this section, we demonstrate the theory proven in the rest of this chapter with a few numerical experiments and examples of families of masks that satisfy the conditions to be spanning families, as established in \cref{thm:meas_cond,cor:gam_fam_span}.  In \cref{sec:reanalyze}, we confirm the existing results for the condition numbers of the measurement operators for Examples 1 and 2 in \cref{sec:MeasMatrix} by applying this theory to them.  In \cref{sec:num_ex}, we numerically compute the condition numbers for a few local Fourier measurement systems that seem intuitive (or practical), but whose condition numbers may be difficult to calculate theoretically.  Additionally, we run this experiment on randomly generated families of masks (both general and Fourier measurement systems) to illustrate the property of spanning families being ``generic,'' in the sense described in \cref{sec:span_fam_remarks}.

\subsection{Explicit Examples of Spanning Families}
\label{sec:reanalyze}

For our analysis of Example 1 of \cref{sec:MeasMatrix}, we rephrase the definition of \eqref{eq:MeasDef} somewhat slightly.  Here, we will take $d \in \N$ to be the ambient dimension and $\delta \le \frac{d + 1}{2}$.  Then, we let $\{m_j(a)\}_{j = 1}^{2 \delta - 1}$ be the local Fourier measurement system with mask $\gamma(a) \in \Rd$ defined by $\gamma(a)_i = a^{i - 1},$ for some $0 < a \in \R, a \neq 1$.  Denoting the condition number of the measurement operator associated to $\{m_j(a)\}_{j \in [2 \delta - 1]}$ by $kappa(a)$, we remark that it suffices to compute (or estimate) $\kappa(a)$ for all $a > 1$, as $\kappa(a) = \kappa(1 / a)$, which is proven in \cref{prop:kap_recip}.

\begin{proposition}
  Given $d \in \N, \delta \le \frac{d + 1}{2},$ and $a \in (0, 1) \cup (1, \infty),$ we define $\{m_j(a)\}_{j \in [2 \delta - 1]}$ to be the local Fourier measurement system of support $\delta$ with mask $\gamma(a) \in \Rd$ defined by \[\gamma(a)_i = \begin{piecewise} a^{i - 1} & i \in [\delta] \\ 0 & \ow \end{piecewise}.\]  Let $\kappa(a) := \kappa(\Ac)$ be the condition number of the measurement operator associated with $\{m_j(a)\}_{j \in [2 \delta - 1]}$.  Then $\kappa(a) = \kappa(1 / a)$.
  \label{prop:kap_recip}
\end{proposition}

\begin{proof}[Proof of \cref{prop:kap_recip}]
  Fix $a > 1$.  We begin by noting that $\gamma(a) = a^{\delta - 1} S^{\delta - 1} R \gamma(a^{-1})$, so that $\norm{\gamma(a)}_2^2 = a^{2 \delta - 2} \norm{\gamma(a^{-1})}_2^2$ and
  \begin{align*}
    \gamma(a) \circ S^{-m} \gamma(a) &= a^{2 \delta - 2} \left(S^{\delta - 1} R \gamma(a^{-1}) \circ S^{-m} S^{\delta - 1} R \gamma(a^{-1})\right) \\
    %% &= a^{2 \delta - 2} S^{\delta - 1} \left(R \gamma(a^{-1}) \circ R S^m \gamma(a^{-1})\right) \\
    %% &= a^{2 \delta - 2} S^{\delta - 1} R (\gamma(a^{-1}) \circ S^m \gamma(a^{-1})) \\
    &= a^{2 \delta - 2} S^{\delta - 1} R S^m (\gamma(a^{-1}) \circ S^{-m} \gamma(a^{-1})),
  \end{align*}
  so that
  \begin{align*}
    f_j^{d *} (\gamma(a) \circ S^{-m} \gamma(a)) &= a^{2 \delta - 2} \omega_d^{-(j - 1) (\delta - m - 1)} f_{2 - j}^{d *} (\gamma(a^{-1}) \circ S^{-m} \gamma(a^{-1})) \\
    &= a^{2 \delta - 2} \omega_d^{-(j - 1) (\delta - m - 1)} \conj{f_j^{d *} (\gamma(a^{-1}) \circ S^{-m} \gamma(a^{-1}))},
  \end{align*}
  which gives, by \cref{prop:gam_fam_cond}, that
  \begin{align*}
    \kappa(a) &= \dfrac{d^{-1/2} \norm{\gamma(a)}_2^2}{\min\limits_{m \in [\delta]_0, j \in [d]} \abs*{f_j^{d*} (\gamma(a) \circ S^{-m} \gamma(a))}} \\ %% \dfrac{\max\limits_{m \in [\delta]_0, j \in [d]} \abs*{a^{2 \delta - 2} \omega_d^{-(j - 1) (\delta - m - 1)} \conj{f_j^{d *} (\gamma(a^{-1})(a^{-1}) \circ S^{-m} \gamma(a^{-1})(a^{-1}))}}}{\min\limits_{m \in [\delta]_0, j \in [d]} \abs*{a^{2 \delta - 2} \omega_d^{-(j - 1) (\delta - m - 1)} \conj{f_j^{d *} (\gamma(a^{-1})(a^{-1}) \circ S^{-m} \gamma(a^{-1})(a^{-1}))}}} = 
    &= \dfrac{d^{-1/2} \norm{\gamma(a^{-1})}_2^2}{\min\limits_{m \in [\delta]_0, j \in [d]} \abs*{f_j^{d*} (\gamma(a^{-1}) \circ S^{-m} \gamma(a^{-1}))}} = \kappa(1 / a)
  \end{align*}  
\end{proof}

We now produce an estimate of $\kappa(a)$ in \cref{prop:exp_kappa}.

\begin{proposition}
  With $d, \delta, \{m_j(a)\}_{j \in [2 \delta - 1]}, \gamma(a), \kappa(a)$ defined as in \cref{prop:kap_recip}, when $a > 1$ we have \begin{equation}\kappa(a) \le \dfrac{a^{2 \delta} - 1}{a^{\delta + 1} - a^{\delta - 1}} \cdot \dfrac{a^2 + 1}{a^2 - 1},\label{eq:kap_est}\end{equation} and when $a \in (0, 1), \kappa(a) = \kappa(1 / a)$.  Taking \[a_\delta = \begin{piecewise} 1 + \frac{4}{\delta - 2} & \delta \ge 5 \\ \frac{1 + \sqrt{5}}{2} & \ow \end{piecewise},\] we may obtain \begin{equation} \kappa(a_\delta) \le \left(\dfrac{\ee (\delta + 2)}{4}\right)^2. \label{eq:kap_opt} \end{equation}
  \label{prop:exp_kappa}
\end{proposition}

\begin{proof}[Proof of \cref{prop:exp_kappa}]
  We fix $a > 1$, and we remark that \begin{equation}\norm{\gamma(a)}_2^2 = \sum_{i = 1}^\delta a^{2(i - 1)} = \dfrac{1 - a^{2 \delta}}{1 - a^2} = \dfrac{a^{2 \delta} - 1}{a^2 - 1}, \label{eq:norm_gam} \end{equation} so all that remains is to bound $\min_{j, m} \abs{f_j^{d*}(\gamma(a) \circ S^{-m} \gamma(a))}$ from below.  For convenience, we define $h(j, m) := \sqrt{d} f_j^{d*}(\gamma(a) \circ S^{-m} \gamma(a)).$  We begin by computing
  \begin{align}
    \abs{h(j, m)} &= \abs*{\sum_{i = 1}^{\delta - m} a^{m + 2 (i - 1)} \omega_d^{-(j - 1)(i - 1)}} \nonumber\\
    &= \abs*{\dfrac{a^m - a^{2 \delta - m} \omega_d^{-(j - 1)(\delta - m)}}{1 - a^2 \omega_d^{-(j - 1)}}} \nonumber\\
    &\ge \abs*{\dfrac{a^{2 \delta - m} - a^m}{a^2 + 1}}.\label{eq:ek_bound}
  \end{align}
  which is clearly decreasing with $m$, so it is minimized when $m = \delta - 1$.  This gives that $\min_{j, m} \abs{f_j^{d*}(\gamma(a) \circ S^{-m} \gamma(a))} \ge \frac{1}{\sqrt{d}} \frac{a^{\delta + 1} - a^{\delta - 1}}{a^2 + 1},$ which, with \eqref{eq:norm_gam} and \cref{prop:kap_recip,prop:gam_fam_cond}, yields \eqref{eq:kap_est}.

  To obtain \eqref{eq:kap_opt}, we consider that \eqref{eq:ek_bound} is necessarily suboptimal.  Consider that, trivially, $h(j, \delta - 1) = \abs{\gamma(a)_1 \gamma(a)_{\delta}} = a^{\delta - 1}$, whereas we have bounded it below by $\frac{a^{\delta + 1} - a^{\delta - 1}}{a^2 + 1} = a^{\delta - 1} \frac{a^2 - 1}{a^2 + 1}.$  Hence, a tighter lower bound may be to use $m = \delta - 2$ in the right hand side of \eqref{eq:kap_opt}.  Using \[\dfrac{a^{\delta + 2} - a^{\delta - 2}}{a^2 + 1} = a^{\delta - 2} \dfrac{a^4 - 1}{a^2 + 1} = a^{\delta - 2} (a^2 - 1),\] this yields \[h(j, m) \ge \min\left(a^{\delta - 1}, a^{\delta - 2} (a^2 - 1)\right).\]  We further observe that $a^{\delta - 2} (a^2 - 1) = a^{\delta - 1}$ exactly when $a^2 - a - 1 = 0$, yielding \[h(j, m) \ge \begin{piecewise} a^{\delta - 1} & a \ge \frac{1 + \sqrt{5}}{2} \\ a^{\delta - 2} (a^2 - 1) & 1 < a \le \frac{1 + \sqrt{5}}{2} \end{piecewise}.\]  Therefore, for $\delta \ge 5$, we have $(1 + \frac{4}{\delta - 2})^{1 / 2} \le \frac{1 + \sqrt{5}}{2}$ so that, choosing $a_\delta = 1 + \frac{4}{\delta - 2}$, we may guarantee
  \begin{gather*}
    \kappa(a_\delta) \le \dfrac{a_\delta^{2 \delta} - 1}{a_\delta^{\delta - 2} (a_\delta^2 - 1)^2} \le \dfrac{a_\delta^{\delta + 2}}{(a_\delta^2 - 1)^2} \\
    = \dfrac{(1 + \frac{4}{\delta - 2})^{(\delta + 2) / 2}}{(4 / (\delta - 2))^2} \le \dfrac{\ee^2 (1 + \frac{4}{\delta - 2})^2}{(4 / (\delta - 2))^2} = \left(\dfrac{\ee (\delta + 2)}{4}\right)^2,
  \end{gather*}
  where the third inequality comes from $(1 + \frac{2}{x})^x \le \ee^2$ for $x > 0$.  For $\delta \in [2, 5)$, setting $\phi = \frac{1 + \sqrt{5}}{2}$, we may upper bound \[\kappa(\phi) \le \dfrac{\phi^{2 \delta} - 1}{\phi^{\delta - 1}},\] and numerically verify that this implies $\kappa(\phi) < (\ee(\delta + 2) / 4)^2$ for $\delta \in [2, 5)$.
  
  %% To find an optimal choice for $a$, we optimize both $\frac{(a^{2 \delta} - 1) / (a^2 - 1)}{a^{\delta - 1}}$ and $\frac{(a^{2 \delta} - 1) / (a^2 - 1)}{a^{\delta - 2}(a^2 - 1)}$.  For the moment, we require $\delta > 2$, and we find that 
  %% \begin{align*}
  %%   \dfrac{a^{2 \delta} - 1}{(a^2 - 1)a^{\delta - 1}} &\le \dfrac{a^{2 \delta}}{(a^2 - 1) a^{\delta - 1}} \\
  %%   &= \dfrac{a^{\delta + 1}}{a^2 - 1},
  %% \end{align*}
  %% which has a single critical point at \[a = \left(\frac{\delta + 1}{\delta - 1}\right)^{1 / 2} = \left(1 + \frac{2}{\delta - 1}\right)^{1 / 2} < (1 + \sqrt{5}) / 2,\] while \[\dfrac{a^{2 \delta} - 1}{a^{\delta - 2}(a^2 - 1)^2} \le \dfrac{a^{\delta + 2}}{(a^2 - 1)^2},\] which has a single minimum at \[a = \left(\frac{\delta + 2}{\delta - 2}\right)^{1 / 2} = \left(1 + \frac{4}{\delta - 2}\right)^{1 / 2},\] which is less than $(1 + \sqrt{5}) / 2$ for $\delta \ge 7$.
  %% \begin{align*}
  %%   \dfrac{a^{2 \delta} - 1}{a^{\delta + 1} - a^{\delta - 1}} \cdot \dfrac{a^2 + 1}{a^2 - 1} &\le \dfrac{a^{2 \delta}}{a^{\delta + 1} - a^{\delta - 1}} \cdot \dfrac{a^2 + 1}{a^2 - 1} \\
  %%   &= \dfrac{a^{\delta + 1}(a^2 + 1)}{(a^2 - 1)^2} \\
  %%   &= \dfrac{a^{\delta + 1}(a^2 + 1)}{(a - 1)^2 (a + 1)^2} \\
  %%   &\le \dfrac{a^{\delta + 1}}{(a - 1)^2}.
  %% \end{align*}
  %% We set $f(a) = a^{\delta + 1} / (a - 1)^2$ and find that its single critical value is a minimum at $a_{\delta} = 1 + \frac{2}{\delta - 1}$.  Using $(1 + x / n)^n \le e^x$ for $x \ge 0$, we have
  %% \begin{align}
  %%   \kappa(a_{\delta}) \le f(a_{\delta}) &= \dfrac{\left(1 + \frac{2}{\delta - 1}\right)^{\delta + 1}}{(2 / (\delta - 1))^2} \le \left(1 + \frac{2}{\delta - 1}\right)^2 \left(\dfrac{\ee (\delta - 1)}{2}\right)^2 \label{eq:a_delta_mid}\\
  %%   &= \left(\dfrac{\ee (\delta + 1)}{2}\right)^2, \nonumber
  %% \end{align}
  %% which completes the proof.
\end{proof}

We remark that the bound in \eqref{eq:kap_opt} is slightly stronger than a similar bound proven in Theorem 4 of \cite{IVW2015_FastPhase}, the work by \citeauthor*{IVW2015_FastPhase} where this family of masks was first studied.  They bounded the condition number for the optimal choice of $a$ by \[\kappa < \max\left\{144 \ee^2, \left(\frac{3 \ee (\delta - 1)}{2}\right)^2 \right\}.\]  For small delta, the term $144 \ee^2 > 1,000$ is much too loose, and even if this term was omitted, $\frac{\delta + 2}{4} < \frac{3(\delta - 1)}{2}$ for all $\delta > 1$.  For asymptotically large $\delta$, the bound proven above in \cref{prop:exp_kappa} is stronger by a constant factor of $36$.
